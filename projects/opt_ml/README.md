# 數據驅動的目標函數估計與最佳化
## 專案簡介

此專案展示了一個數據驅動的目標函數估計與最佳化流程。透過結合數據模擬、表面估計及優化技術，針對複雜或無法明確表達的目標函數進行反應曲面的建模與估計，進一步實現基於該反應曲面的最佳化，求得使目標函數 $\hat{f}(x)$ 最小化或最大化的最佳解 $x$。

## 專案動機

實務上，$y$ 與 $x$ 之間的關係往往難以用單一函數形式 $y = f(x)$ 精確描述，或者該函數可能會隨時間動態變化為 $y = f(x, t)$。這種情況下，目標函數的不可明確性為最佳化過程帶來挑戰。為了解決此問題，我們引入機器學習技術，以近似方式估計函數 $f(x)$，並建立一個學習到的函數 $\hat{f}(x)$。基於此估計函數 $\hat{f}(x)$，我們可以進一步進行目標函數的最佳化，從而找到使目標值最小化或最大化的最佳解 $x$，並隨時檢視模型成效，適時重新訓練。這一方法有效地應對了目標函數不明確或動態變化所帶來的挑戰。

## 專案內容

### 方法模擬：

將我們的方法應用於模擬生成的數據上，假設數據來自以下目標函數分佈：

``` python
def f1(x1, x2):
   return (-np.cos(np.pi * (x1)) * np.cos(2 * np.pi * (x2))) / (
      1 + np.power(x1, 2) + np.power(x2, 2)
   )
```

1. 隨機生成 3000 筆帶有隨機誤差的資料 $(x_1, x_2)$，並假設隨機誤差分布符合常態分布，標準差為 0.1。
2. 將生成的資料 $(x_1, x_2)$ 輸入深度學習模型 $\hat{f}$，生成估計值 $\hat{y}$。
3. 使用均方根誤差損失（RMSE Loss）計算 $\hat{y}$ 與真實值 $y$ 的誤差。
4. 模型訓練持續 $100$ 個梯次後收斂，其配適結果如 **下圖左** 所示，$R^2 = 0.98$。
5. 對已收斂的估計反應曲面 $\hat{f}$ 使用粒子群最佳化（PSO），最終收斂至全域最小值。結果展示於 **下圖右**，可以看到粒子群完美地找到目標函數的最小值。


![Descent Plot](./plots/simulate_F1.gif)
![Descent Plot](./plots/simulate_F2.gif)

### 實際資料應用：
![Data Logo](./plots/logo-xs.svg)

後將我們的方法應用於實際資料，該資料取自[內政部不動產交易實價查詢服務網](https://plvr.land.moi.gov.tw/DownloadOpenData)，取2024年第二季與第三季的預售屋成交資料進行模型 $\hat{f}(x)$ 建置，並透過 Differential evolution 最佳化，在限制的空間中(地點在臺中市西區，建物＋車位總面積超過200平方公尺空間)找到最佳的價格。
![Descent Plot](./plots/housing.gif)
其中$x_1$與$x_2$分別代表車位總面積與建物總面積，紅色虛線則代表建物＋車位總面積為200平方公尺之界線，在如此範圍內找到最佳物件為：車位40平方公尺，建物160平方公尺，價格預估為23379480元。

